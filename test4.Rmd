---
title: "test4"
output: html_document
---

# https://rstudio-pubs-static.s3.amazonaws.com/66713_2ae121fc81a844ce9d5d8ef91900717f.html

```{r}
a=read.csv('pml-training.csv',na.strings=c('','NA'))
b=a[,!apply(a,2,function(x) any(is.na(x)) )]
c=b[,-c(1:7)]

library('randomForest')
library('caret')
library('e1071')
```

```{r, cross_validation}
subGrps=createDataPartition(y=c$classe, p=0.6, list=FALSE)
subTraining=c[subGrps,]
subTesting=c[-subGrps, ]
dim(subTraining);dim(subTesting)

model=randomForest(classe~., data=subTraining, method='class')
pred=predict(model,subTesting, type='class')
z=confusionMatrix(pred,subTesting$classe)
save(z,file='test.RData')

load('test.RData')
z$table
```

```{r}
z$overall[1]
```

Final Data Set Analysis and Predictions

```{r}
d=read.csv('pml-testing.csv',na.strings=c('','NA'))
e=d[,!apply(d,2,function(x) any(is.na(x)) )]
f=e[,-c(1:7)]

predicted=predict(model,f,type='class')
predicted
```
